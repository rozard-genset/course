{{- $image := "" -}}

{{- if .Page.Params.Metadata.thumb  -}}
    {{- $image = .Page.Resources.GetMatch .Page.Params.Metadata.thumb -}}
{{- end -}}

{{- if .Page.Params.Module.Cover -}}
    {{- $image = .Page.Resources.GetMatch .Page.Params.Module.Cover -}}
{{- end -}}

{{- if $image -}}
    <picture class="rounded-2xl">
        {{- $low := $image.Fill "128x128" -}}{{- $low = $low.Resize "128x128 webp q100" -}}
        <source media="(width < 481px)" srcset="{{ $low.RelPermalink }}" />

        {{- $mid := $image.Resize "320x webp q100" -}}
        <source media="(width > 481px)" srcset="{{ $mid.RelPermalink }}" />

        {{- $top := $image.Resize "300x webp q100" -}}
        <img src="{{ $top.RelPermalink }}" width="{{ $top.Width }}" height="{{ $top.Height }}" alt="{{ .Title }}" title="{{ .Title }}" loading="lazy" />
    </picture>    
 {{- end -}}